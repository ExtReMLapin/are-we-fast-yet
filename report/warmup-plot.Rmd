# Warmup Plots of the Data Set

```{r prepare-data, echo=TRUE, message=TRUE, warning=TRUE, dev='svg'}
# load libraries, the data, and prepare it
if (Sys.getenv("RSTUDIO") == "1") { setwd("/Users/smarr/Projects/PostDoc/FASTXX/are-we-fast-yet/report") }

source("scripts/libraries.R", chdir=TRUE)

warmup_plot <- function (data_c, b, c) {
  ## First take the medians over the values for each VM separated
  medians <- ddply(data_c, ~ VM, summarise,
             median = median(Value))
  # use the highest one with a little margin as an upper bound
  upperBound <- 2 * max(medians$median)
  data_c <- ddply(data_c, ~ Benchmark, here(transform),
                  ValCut = pmin(Value, upperBound))

  plot <- ggplot(data_c, aes(x=Iteration, y=ValCut))
  plot <- plot + geom_line(aes(colour = VM))
  plot <- plot + ggtitle(paste0(b, " Cores: ", c))
  plot <- plot + scale_x_continuous(breaks = seq(0, max(data_c$Iteration), 100))
  plot <- plot + geom_vline(xintercept = c(100, 200, 300), linetype = "longdash", colour = "#cccccc")
  plot <- plot + theme_simple()
  print(plot)
}
```

# Plots, Sequential Perf

```{r awfy-warmup-plots, echo=FALSE, dev='png', fig.keep='all', fig.width=10, fig.height=6}

data <- load_data_file("data/all/160-savina-fbe9bc5e/benchmark.data")
data <- droplevels(subset(data, Criterion == "total", select = c(Value, Unit, Benchmark, VM, Cores, Iteration)))
data <- prepare_vm_names(data)
data$Cores <- as.factor(data$Cores)

# b <- "BankTransaction"
# c <- 1

for (b in levels(data$Benchmark)) {
  data_b <- droplevels(subset(data, Benchmark == b))
  
  for (c in levels(data_b$Cores)) {
    data_c <- droplevels(subset(data_b, Cores == c))
    warmup_plot(data_c, b, c)
  }
}
```

# Plots, Actor Perf

```{r savina-warmup-plots, echo=FALSE, dev='png', fig.keep='all', fig.width=10, fig.height=6}

data <- load_data_file("data/all/136-savina-8c3f6ec5/benchmark.data")

## For Savina benchmarks use Var for VM, makes subsequent handling easier
data <- transform(data, VM = ifelse(VM == "Scala", as.character(Var), as.character(VM)))
data$VM <- as.factor(data$VM)
data$Cores <- as.factor(data$Cores)

data <- subset(data, select = c(Value, Unit, Benchmark, VM, Cores, Iteration))
data <- prepare_vm_names(data)


b <- "Mandelbrot"

for (b in levels(data$Benchmark)) {
  data_b <- droplevels(subset(data, Benchmark == b))
  
  for (c in levels(data_b$Cores)) {
    data_c <- droplevels(subset(data_b, Cores == c))
    warmup_plot(data_c, b, c)
  }
}
```
